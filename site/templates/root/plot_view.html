<!--{extends file="root.html"}-->
<!--{block name="content"}-->
    <!-- Page Heading -->
    <h1 class="h3 mb-2 text-gray-800"><!--{$item->name}--> Plot View</h1>
    <!-- DataTales Example -->
        <div class="row">
          <div class="col-12">
            <div class="card-body">
              <div class="row w-100">
                <div class="col-md-4 card">
                  <form action="<!--{$Site.siteProtocol}--><!--{$Site.domainName}-->/root/plot_view?item=<!--{$item->id}-->&type=<!--{$table}-->" method="POST">
                    <div class="row card-body">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label for="clients" class="form-control-label">Clients </label>
                          <select name="client" id="clients" class="form-control clients ">
                            <option i='' value="">Choose</option>
                            <!--{if !empty($pclients)}-->
                              <!--{foreach $pclients as $product}-->
                                <option i='<!--{json_encode($product)}-->' value="<!--{$product->token}-->"><!--{$product->token}-->: <!--{$product->firstname}--> <!--{$product->surname}--></option>
                              <!--{/foreach}-->
                            <!--{/if}-->
                          </select>
                        </div>
                        <div class="form-group">
                          <div class="card">
                            <p class="card-body p-3" id="client_details">
      
                            </p>
                          </div>
                        </div>
                        <div class="form-group">
                          <input type="hidden" name="plotid" readonly class="form-control" value="" id="plotId">
                        </div>
                        <div class="form-group">
                          <button class="btn p-2 btn-primary " name="triggers" value="allocate_plot" >Submit</button>
                        </div>
                      </div>
                    </div>
                  </form>
                </div>
                <div class=" col-md-4">
                <form class="" action="<!--{$Site.siteProtocol}--><!--{$Site.domainName}-->/root/plot_view?item=<!--{$item->id}-->&type=<!--{$table}-->" method="POST">
                  <div class="row">
                    <div class="col-md-12">
                      <div class="form-group">
                        <button class="btn p-2 btn-danger" onclick="return deleteItem();" name="triggers" value="recreate_allocation" >Recreate</button>
                      </div>
                    </div>
                  </div>
                </form>
                </div>
                <div class="col-md-6 card">
                  <div class="card-body">
                    <div class="row justify-content-end">
                      <div class="col-md-12">
                        <form class="" action="<!--{$Site.siteProtocol}--><!--{$Site.domainName}-->/root/plot_view?item=<!--{$item->id}-->&type=<!--{$table}-->" method="POST">
                          <div class="row w-100">
                            <div class="col-md-8">
                              <div class="form-group">
                                <label for="type_plot">
                                Select Plot
                                </label> 
                                <br>
                                <select name="plotid2" class="form-control" id="plotid2">
                                  <option selected disabled value="">
                                    Choose Plot 
                                  </option>
                                  <!--{if !empty($allocations)}-->
                                      <!--{foreach $allocations as $allocate}-->
                                        <option value="<!--{$allocate->id}-->">Plot <!--{$allocate->id}--></option>
                                      <!--{/foreach}-->
                                    <!--{/if}-->
                                </select>
                              </div> 
                            </div>
                            </div>
                            <div class="col-md-8">
                              <div class="form-group">
                                <label for="type_plot">
                                 Assign Plot Info
                                </label> 
                                <br>
                                <select name="type_plot" class="form-control" id="type_plot">
                                  <option selected disabled value="">
                                    Choose Plot Type
                                  </option>
                                  <option value="recreational">
                                    Recreational
                                  </option>
                                  <option value="commercial">
                                    Commercial
                                  </option>
                                  <option value="institutional">
                                    Institutional
                                  </option>
                                  <option value="residential">
                                    Residential
                                  </option>
                                </select>
                              </div>
                            </div>
                            <div class="col-md-12">
                              <div class="row w-100">
                                <div class="col-md-8">
                                  <div class="form-group">
                                    <label for="coords">
                                     Assign Plot Cordinates
                                    </label> 
                                    <input type="text" name="coords" id="coords" class="form-control">
                                  </div>
                                </div>
                                <div class="col-md-3">
                                  <div class="form-group">
                                    <label for=""> 
                                      Click to display
                                    </label> 
                                    <button class="btn btn-danger" type="button" onclick="$('#imageMap').toggle()">Get Coords</button>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="col-md-8">
                              <div class="form-group">
                                <label for="plot_shape">
                                 Assign Plot Cordinates Shape
                                </label> 
                                <select name="plot_shape" class="form-control" id="plot_shape">
                                  <option selected disabled value="">
                                    Choose Plot Shape
                                  </option>
                                  <option value="rect">
                                    Rect
                                  </option>
                                  <option value="poly">
                                    Poly
                                  </option>
                                  <option value="circle">
                                    Circle
                                  </option>
                                </select>
                              </div>
                            </div>
                            <div class="col-md-8">
                              <div class="form-group">
                                <button class="btn p-2 btn-success" name="triggers" value="assign_type_allocation" >Assign Type</button>
                              </div>
                            </div>
                        </form>
                      </div>
                      </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group">
                  <!--{if !empty($fail)}-->
                    <!--{$fail}-->
                  <!--{/if}-->
                </div>
              </div>
              <div class="col-md-12">
                <div class="form-group" style="display: none;" id="imageMap">
                  <iframe src="https://www.image-map.net/" name="iframe_a" height="500px" width="100%" title="Image Tool Kit"></iframe>
                </div>
              </div>
            </div>
          </div>
        </div>
          <div class="row justify-content-center">
            <!--{if !empty($item)}-->
              <div class="col-md-6">
                <div class="card">
                  <div class="card-body">
                      <div class="row w-100">
                        <div class="col-md-12">
                          <div class="table-responsive">
                            
                          <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                            <thead class="thead-light">
                            <tr>
                              <th scope="col">Plot Num</th>
                              <th scope="col">Client</th>
                              <th scope="col">Plot Type</th>
                              <th scope="col">Date Allocated</th>
                              <th>Details</th>
                            </tr>
                          </thead>
                          <tfoot>
                            <tr>
                              <th scope="col">Plot Num</th>
                              <th scope="col">Client</th>
                              <th scope="col">Plot Type</th>
                              <th scope="col">Date Allocated</th>
                              <th>Details</th>
                          </tr>
                          </tfoot>
                          <tbody>
                              <!--{foreach $allocations as $referral}-->
                                <tr id='row_<!--{$referral->id}-->'>
                                  <td><!--{$referral->id}--></td>
                                  <td>
                                    <!--{$referral->client}-->
                                  </td>
                                  <td>
                                    <!--{$referral->type|ucwords}-->
                                  </td>
                                  <td>
                                     <!--{if !empty($referral->dateadded)}--> <!--{$referral->dateadded|date_format}--> <!--{/if}-->
                                  </td>
                                  <td>
                                     <!--{if !empty($referral->token)}--> 
                                      <a class="btn btn-success" href="<!--{$Site.siteProtocol}--><!--{$Site.domainName}-->/root/view_<!--{$sub_table}-->?id=<!--{$referral->token}-->">Details</a>
                                     <!--{/if}-->
                                  </td>
                                </tr>
                            <!--{/foreach}-->
                          </tbody>
                          </table>
                          </div>
                        </div>
                      </div>
                  </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="row w-100">
                  <div class="col-md-12 px-4">
                    <h4>Legend:</h4>
                    <div class="form-group row">
                      <button class="btn btn-success border border-success mx-2" type="button" disabled="disabled">Allocated</button>
                      <button style="background-color: #fff;" class="btn border-success mx-2 btn-light" disabled="disabled" type="button" >Unallocated</button>
                      <button class="btn border-success btn-warning mx-2" type="button" disabled="disabled">Selected</button>
                    </div>
                  </div>
                </div>
                <div class="card plot-holder">
                  <div class="card-body imagemaps-wrapper">
                    <img id="myimage" src="<!--{$Site.siteProtocol}--><!--{$Site.domainName}-->/<!--{$item->plot_image}-->" width="100%" alt="<!--{$item->name}-->"  usemap="#<!--{$item->token}-->" draggable="false">
                      <map class="imagemaps" id="mapping" name="<!--{$item->token}-->">
                        <!--{if !empty($allocations)}-->
                          <!--{foreach $allocations as $allocate}-->
                            <area data-key="<!--{$allocate->id}-->" href="#" c='' a = '<!--{$allocate->client}-->' alt="<!--{$allocate->id}-->" title="<!--{$allocate->id}-->"  coords="<!--{$allocate->coords}-->" shape="<!--{$allocate->shape}-->">
                          <!--{/foreach}-->
                        <!--{/if}-->
                      </map>
                  </div>
                </div>
            </div>
            <!--{else}-->
                <h2>Not Found</h2>
            <!--{/if}-->
          </div>
<!--{/block}-->