<!--{extends file="root.html"}-->
<!--{block name="content"}-->
    <!-- Page Heading -->
    <h1 class="h3 mb-2 text-gray-800"><!--{$item->name}--> Plot Allocation</h1>
    <!-- DataTales Example -->
        <div class="row">
          <div class="col-12">
            <div class="card-body">
              <form action="<!--{$Site.siteProtocol}--><!--{$Site.domainName}-->/root/plot_allocation?item=<!--{$item->id}-->&type=<!--{$table}-->" method="POST">
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="clients" class="form-control-label">Clients </label>
                      <select name="client" id="clients" class="form-control clients ">
                        <option i='' value="">Choose</option>
                        <!--{if !empty($pclients)}-->
                          <!--{foreach $pclients as $product}-->
                            <option i='<!--{json_encode($product)}-->' value="<!--{$product->token}-->"><!--{$product->token}-->: <!--{$product->firstname}--> <!--{$product->surname}--></option>
                          <!--{/foreach}-->
                        <!--{/if}-->
                      </select>
                    </div>
                    <div class="form-group">
                      <div class="card">
                        <p class="card-body p-3" id="client_details">
  
                        </p>
                      </div>
                    </div>
                    <div class="form-group">
                      <input type="hidden" name="plotid" readonly class="form-control" value="" id="plotId">
                    </div>
                    <div class="form-group">
                      <button class="btn p-2 btn-primary " name="triggers" value="allocate_plot" >Submit</button>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <!--{if !empty($fail)}-->
                        <!--{$fail}-->
                      <!--{/if}-->
                    </div>
                  </div>
                </div>
              </form>
              <form class="d-none" action="<!--{$Site.siteProtocol}--><!--{$Site.domainName}-->/root/plot_allocation?item=<!--{$item->id}-->&type=<!--{$table}-->" method="POST">
                <div class="row">
                  <div class="col-md-12">
                    <div class="form-group">
                      <button class="btn p-2 btn-danger" onclick="return deleteItem();" name="triggers" value="recreate_allocation" >Recreate</button>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
          <div class="row justify-content-center">
            <!--{if !empty($item)}-->
              <div class="col-md-6">
                <div class="card">
                  <div class="card-body">
                      <div class="row w-100">
                        <div class="col-md-12">
                          <div class="table-responsive">
                            
                          <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                            <thead class="thead-light">
                            <tr>
                              <th scope="col">Plot Num</th>
                              <th scope="col">Client</th>
                              <th scope="col">Date Allocated</th>
                              <th>Details</th>
                            </tr>
                          </thead>
                          <tfoot>
                            <tr>
                              <th scope="col">Plot Num</th>
                              <th scope="col">Client</th>
                              <th scope="col">Date Allocated</th>
                              <th>Details</th>
                          </tr>
                          </tfoot>
                          <tbody>
                              <!--{foreach $allocations as $referral}-->
                                <tr>
                                  <td><!--{$referral->id}--></td>
                                  <td>
                                    <!--{$referral->client}-->
                                  </td>
                                  <td>
                                     <!--{if !empty($referral->dateadded)}--> <!--{$referral->dateadded|date_format}--> <!--{/if}-->
                                  </td>
                                  <td>
                                     <!--{if !empty($referral->token)}--> 
                                      <a class="btn btn-success" href="<!--{$Site.siteProtocol}--><!--{$Site.domainName}-->/root/view_<!--{$sub_table}-->?id=<!--{$referral->token}-->">Details</a>
                                     <!--{/if}-->
                                  </td>
                                </tr>
                            <!--{/foreach}-->
                          </tbody>
                          </table>
                          </div>
                        </div>
                      </div>
                  </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="row w-100">
                  <div class="col-md-12 px-4">
                    <h4>Legend:</h4>
                    <div class="form-group row">
                      <button class="btn btn-success border border-success mx-2" type="button" disabled="disabled">Allocated</button>
                      <button style="background-color: #fff;" class="btn border-success mx-2 btn-light" disabled="disabled" type="button" >Unallocated</button>
                      <button class="btn border-success btn-warning mx-2" type="button" disabled="disabled">Selected</button>
                    </div>
                  </div>
                </div>
                <div class="card plot-holder">
                  <div class="card-body">
                    <div class="row w-100 d-flex">
                      <!--{if !empty($allocations)}-->
                        <!--{foreach $allocations as $allocate}-->
                          <div class="col my-1">
                            <div class="plot">
                              <button id='<!--{$allocate->id}-->' i='<!--{$allocate->id}-->' d='' e='' c = '<!--{$allocate->client}-->' class="btn plotItem <!--{if !empty($allocate->client)}--> bg-success <!--{/if}--> w-100 h-100">
                                  <!--{$allocate->id}-->
                              </button>
                            </div>
                          </div>
                        <!--{/foreach}-->
                      <!--{/if}-->
                    </div>
                  </div>
                </div>
            </div>
            <!--{else}-->
                <h2>Not Found</h2>
            <!--{/if}-->
          </div>
<!--{/block}-->